<dom-module id="bss-app">
    <template>

        <style>
            :host {
                --app-primary-color: #4285f4;
                --app-secondary-color: black;
                display: block;
            }

        </style>

        <firebase-app auth-domain="bss-app-5e2a0.firebaseapp.com"
                      database-url="https://bss-app-5e2a0.firebaseio.com"
                      api-key="AIzaSyBpEg71NVOJ_PLh6sZcKsLm9np04fF2l6I">
        </firebase-app>
        <bss-login id="login"></bss-login>
        <bss-layout id="main"></bss-layout>


    </template>

</dom-module>


<script src="https://www.gstatic.com/firebasejs/4.6.1/firebase.js"></script>

<script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyBpEg71NVOJ_PLh6sZcKsLm9np04fF2l6I",
        authDomain: "bss-app-5e2a0.firebaseapp.com",
        databaseURL: "https://bss-app-5e2a0.firebaseio.com",
        projectId: "bss-app-5e2a0",
        storageBucket: "bss-app-5e2a0.appspot.com",
        messagingSenderId: "225086584681"
    };
    firebase.initializeApp(config);
</script>


<script>
    class BssApp extends Polymer.Element {
        static get is() {
            return 'bss-app';
        }

        static get config() {
            return {
                properties: {
                },
            }
        }
        connectedCallback() {
            super.connectedCallback();
            requestAnimationFrame(this._installListeners.bind(this));
        }
        _installListeners() {
            window.addEventListener('auth-changed', this._onAuthChanged.bind(this));
        }


        _onAuthChanged(data){
            var user = data.detail.user;
            var el = this;
            if(!!user){
                Polymer.Utils.importHref(
                    this.resolveUrl('bss-layout.html'), function(){
                        el.$.login.hidden = true;
                        el.$.main.hidden = false;
                        el.$.main.resizeHeader();
                    });

            }else{
                this.$.login.hidden = false;
                this.$.main.hidden = true;
            }
        }
    }
    customElements.define(BssApp.is, BssApp);
</script>




